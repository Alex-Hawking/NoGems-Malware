# NoGems?

![NoGems Logo](report/images/ng_logo.png)

## Overview

**NoGems?** is a multi-platform, persistent, evasive, and mutating malware developed in 24 hours as part of a lab exercise in the **University of Western Australia's CITS3006 Penetration Testing Unit**. The malware is designed to infect both Windows and Debian-based operating systems, demonstrating techniques commonly used by malicious software to achieve persistence, evade detection, and exfiltrate data.

This project is for educational purposes, showcasing how malware can be created and analyzed. The keylogging malware implements basic features, such as establishing persistence, cloning itself, mutating to avoid detection, and securely transmitting captured data to a remote server.

> **Note**: While the code was created within a 24-hour period, the production listener and compiled executables have been
modified slightly to safely exfiltrate to the externally hosted listener, additional cleanup and formatting has also been applied to the source code.

## How to Run

### Prerequisites

- **Python 3.8+** installed on your system.
- **Virtual machine to install and run the malware (Windows/Debian based)** (recommended).

### Setup

The following steps explain how to locally host the platform for downloading the malware onto the victim's VM.

1. **Clone the Repository**:
   ```bash
   git clone https://github.com/Alex-Hawking/nogems-malware.git
   cd nogems/attacker/web
   ```

2. **Create and Activate a Virtual Environment:**:
   ```bash
    python -m venv venv
    venv/Scripts/activate  # On Windows
    source venv/bin/activate  # On Linux/Mac
   ```

3. **Install Required Packages:**:
   ```bash
   pip install -r requirements.txt
   ```

4. **Configure VM settings:**
    Ensure your VM is able to access the server running on your host by configuring the network settings as follows:

   - **Network Adapter**: Set to **Bridged Adapter** to allow the VM to be on the same network as your host machine.
   - **Promiscuous Mode**: Set to **Allow All** to ensure that the VM can communicate with the host and other devices on the network.
   - **IP Configuration**: Ensure that the VM receives an IP address on the same subnet as your host machine, either through DHCP or by manually assigning an IP address.

   This configuration will allow the VM to access the web server running on your host machine for downloading the malware and exfiltrating data.

   It is also recommended to save a 'pre malware' snapshot of your VM, to easily revert VM states.

### Running the malware

**On the host machine**
1. **Run the download site:**
    (from within `attacker/web`)
    ```
    python3 app.py
    ```

**On the victim VM:**
1. **Navigate to the website and download website:**
    Copy and past the appropriate address displayed in the program output into your VMs browser and download the malware onto the victim machine.

2. **Run the malware:**
    (*NOTE: on Windows Defender must be disabled*)
    **Windows:** Navigate to the program and run it as you would any other exe, it should prompt for admin priviledges.
    **Debian:** 
    1. Make the download executable: `chmod +x /path/to/malware`
    2. Run with *sudo*: `sudo ./path/to/malware`

3. **Interact with NoGems?:**
    Once the malware is running all keystrokes will be exfiltrated and displayed on:
    [https://nogemsmalware.duckdns.org/](https://nogemsmalware.duckdns.org/)

    For further analysis, see the source code and report to see what other behaviour is exhibited by NoGems, a brief rundown is below.

## General Lifecycle

1. **Initial Distribution**: Social engineering techniques lure users into downloading the malware, disguised as a tool for obtaining free in-game resources.
2. **Execution**: The malware checks for privileges, clones itself, mutates to avoid detection, and sets up mechanisms to run on startup.
3. **Obfuscation and Mutation**: The code is obfuscated using PyArmor, and the executable is bundled with PyInstaller.
4. **Persistence Mechanisms**: The malware modifies system settings to ensure it runs every time the system is restarted.
5. **Keylogging and Data Exfiltration**: Captured keystrokes are securely sent to a remote server.
6. **User Notification**: Alerts the user that their keystrokes are being logged.
7. **Self-Destruction**: The original file is deleted after cloning to minimize traces of the malware.
8. **Reinjection into Startup**: The malware re-adds itself to the startup sequence every time it runs.


### Security Note

The production listener and compiled executables are modified to include security features such as authentication tokens, ensuring that they are not trivially exploitable. These modifications ensure the safety and ethical use of this demonstration project.
Disclaimer

This project is strictly for educational purposes and should not be used in any real-world attacks or malicious activities. The goal is to demonstrate how malware works and to provide insights into how such threats can be mitigated.


### Key Points in the README:

1. **Overview**: Brief introduction to the project, mentioning that it’s for educational purposes.
2. **Features**: Lists the main functionalities of the malware.
3. **General Lifecycle**: Outlines the stages of the malware’s execution.
4. **How to Run**: Step-by-step instructions on how to set up, compile, and run the malware on both Windows and Debian-based systems.
5. **Listener Setup**: Instructions for setting up the listener to capture keystrokes.
6. **Security Note**: Mentions that the production version has additional security features.
7. **Disclaimer**: Reinforces that the project is for educational use only.